"namespace IPS\\Theme;\nclass class_core_global_global\n{\n\t\t\tfunction advertisementImage( $advertisement, $acpLink=NULL ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\nCONTENT;\n\nif ( count( $advertisement->_images ) ):\n$return .= <<<CONTENT\n\n<div class='ipsAdvertisement ipsSpacer_both ipsSpacer_half'>\n\t<ul class='ipsList_inline ipsType_center ipsList_reset'>\n\t\t<li class='ipsAdvertisement_large ipsResponsive_showDesktop ipsResponsive_inlineBlock ipsAreaBackground_light ipsPad_half'>\n\t\t\t\nCONTENT;\n\nif ( $advertisement->link ):\n$return .= <<<CONTENT\n\n\t\t\t\t<a href='\nCONTENT;\n\nif ( $acpLink ):\n$return .= <<<CONTENT\n\nCONTENT;\n$return .= htmlentities( $acpLink->makeSafeForAcp(), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\nCONTENT;\n$return .= str_replace( '&', '&amp;', \\IPS\\Http\\Url::internal( \"app=core&module=system&controller=redirect&do=advertisement&ad=$advertisement->id\" . \"&csrfKey=\" . \\IPS\\Session::i()->csrfKey, \"front\", \"\", array(), 0 ) );\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n' target='_blank'>\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t<img src='\nCONTENT;\n$return .= htmlentities( $advertisement->_images['large'], ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' alt=\"\nCONTENT;\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'advertisement_alt', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\" class='ipsImage'>\n\t\t\t\nCONTENT;\n\nif ( $advertisement->link ):\n$return .= <<<CONTENT\n\n\t\t\t\t<\/a>\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t<\/li>\n\t\t\nCONTENT;\n\nif ( !empty( $advertisement->_images['medium'] ) ):\n$return .= <<<CONTENT\n\n\t\t\t<li class='ipsAdvertisement_medium ipsResponsive_showTablet ipsResponsive_inlineBlock ipsAreaBackground_light ipsPad_half'>\n\t\t\t\t\nCONTENT;\n\nif ( $advertisement->link ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<a href='\nCONTENT;\n\nif ( $acpLink ):\n$return .= <<<CONTENT\n\nCONTENT;\n$return .= htmlentities( $acpLink->makeSafeForAcp(), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\nCONTENT;\n$return .= str_replace( '&', '&amp;', \\IPS\\Http\\Url::internal( \"app=core&module=system&controller=redirect&do=advertisement&ad=$advertisement->id\" . \"&csrfKey=\" . \\IPS\\Session::i()->csrfKey, \"front\", \"\", array(), 0 ) );\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n' target='_blank'>\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t<img src='\nCONTENT;\n$return .= htmlentities( $advertisement->_images['medium'], ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' alt=\"\nCONTENT;\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'advertisement_alt', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\" class='ipsImage'>\n\t\t\t\t\nCONTENT;\n\nif ( $advertisement->link ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<\/a>\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t<\/li>\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nif ( !empty( $advertisement->_images['small'] ) ):\n$return .= <<<CONTENT\n\n\t\t\t<li class='ipsAdvertisement_small ipsResponsive_showPhone ipsResponsive_inlineBlock ipsAreaBackground_light ipsPad_half'>\n\t\t\t\t\nCONTENT;\n\nif ( $advertisement->link ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<a href='\nCONTENT;\n\nif ( $acpLink ):\n$return .= <<<CONTENT\n\nCONTENT;\n$return .= htmlentities( $acpLink->makeSafeForAcp(), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\nCONTENT;\n$return .= str_replace( '&', '&amp;', \\IPS\\Http\\Url::internal( \"app=core&module=system&controller=redirect&do=advertisement&ad=$advertisement->id\" . \"&csrfKey=\" . \\IPS\\Session::i()->csrfKey, \"front\", \"\", array(), 0 ) );\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n' target='_blank'>\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t<img src='\nCONTENT;\n$return .= htmlentities( $advertisement->_images['small'], ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' alt=\"\nCONTENT;\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'advertisement_alt', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\" class='ipsImage'>\n\t\t\t\t\nCONTENT;\n\nif ( $advertisement->link ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<\/a>\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t<\/li>\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t<\/ul>\n\t\nCONTENT;\n\nif ( $acpLink ):\n$return .= <<<CONTENT\n\n\t\t<div class=\"ipsType_center ipsType_small\"><a href=\"\nCONTENT;\n$return .= htmlentities( $acpLink->makeSafeForAcp(), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\">\nCONTENT;\n$return .= htmlentities( $acpLink, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/a><\/div>\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n<\/div>\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\nCONTENT;\n\t\treturn $return;\n}\n\n\tfunction chart( $chart, $type, $options, $format=NULL ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n<table class=\"ipsTable\" data-ipsChart data-ipsChart-type=\"\nCONTENT;\n$return .= htmlentities( $type, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" data-ipsChart-extraOptions='{$options}' \nCONTENT;\n\nif ( $format ):\n$return .= <<<CONTENT\ndata-ipsChart-format='\nCONTENT;\n$return .= htmlentities( $format, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n>\n\t<thead>\n\t\t<tr>\n\t\t\t\nCONTENT;\n\nforeach ( $chart->headers as $header => $type ):\n$return .= <<<CONTENT\n\n\t\t\t\t<th data-colType=\"$type\">\nCONTENT;\n$return .= htmlentities( $header, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/th>\n\t\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t\t<\/tr>\n\t<\/thead>\n\t<tbody>\n\t\t\nCONTENT;\n\nforeach ( $chart->rows as $row ):\n$return .= <<<CONTENT\n\n\t\t\t<tr>\n\t\t\t\t\nCONTENT;\n\nforeach ( $row as $value ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<td>\nCONTENT;\n$return .= htmlentities( $value, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/td>\n\t\t\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t\t\t<\/tr>\n\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t<\/tbody>\n<\/table>\n<div><\/div>\nCONTENT;\n\t\treturn $return;\n}\n\n\tfunction dynamicChart( $chart, $html ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n<div class='ipsChart' data-controller='core.admin.core.dynamicChart' data-chart-url='\nCONTENT;\n$return .= htmlentities( $chart->baseURL, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-chart-identifier='\nCONTENT;\n$return .= htmlentities( $chart->identifier, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-chart-type=\"\nCONTENT;\n$return .= htmlentities( $chart->type, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" data-chart-timescale=\"\nCONTENT;\n$return .= htmlentities( $chart->timescale, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\">\n\t<div class='ipsPad ipsAreaBackground ipsClearfix'>\n\t\t\nCONTENT;\n\nif ( $chart->title ):\n$return .= <<<CONTENT\n\n\t\t\t<h2 class='ipsType_sectionHead'>\nCONTENT;\n$return .= htmlentities( $chart->title, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/h2>\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t<ul class='ipsList_inline'>\n\t\t\t<li data-role=\"groupingButtons\">\n\t\t\t\t<span class=\"ipsButton_split ipsClearfix\">\n\t\t\t\t\t\nCONTENT;\n\nforeach ( array( 'daily', 'weekly', 'monthly' ) as $k ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<a class='ipsButton ipsButton_verySmall \nCONTENT;\n\nif ( $chart->type == 'Table' ):\n$return .= <<<CONTENT\nipsButton_disabled ipsButton_veryLight\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\nCONTENT;\n\nif ( $chart->timescale == $k ):\n$return .= <<<CONTENT\nipsButton_primary\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\nipsButton_veryLight\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n' href=\"\nCONTENT;\n$return .= htmlentities( $chart->url->setQueryString( array( 'timescale' => array( $chart->identifier => $k ), 'noheader' => 1 ) ), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" data-timescale=\"\nCONTENT;\n$return .= htmlentities( $k, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" \nCONTENT;\n\nif ( $chart->timescale == $k ):\n$return .= <<<CONTENT\ndata-selected\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n>\nCONTENT;\n$val = \"stats_date_group_$k\"; $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( $val, \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t\t\t\t<\/span>\n\t\t\t<\/li>\n\t\t\t<li class=\"ipsClearfix\">\n\t\t\t\t<a data-action='chartDate' data-ipsMenu data-ipsMenu-closeOnClick='false' id='el\nCONTENT;\n$return .= htmlentities( $chart->identifier, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\nDate' href=\"#\" class=\"ipsButton ipsButton_verySmall ipsButton_veryLight\"><i class='fa fa-calendar'><\/i> &nbsp;\nCONTENT;\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'stats_date_range', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n <i class='fa fa-caret-down'><\/i><\/a>\n\t\t\t\t<div id='el\nCONTENT;\n$return .= htmlentities( $chart->identifier, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\nDate_menu' class='ipsMenu ipsMenu_normal ipsHide ipsPad'>\n\t\t\t\t\t<form accept-charset='utf-8' action=\"\nCONTENT;\n$return .= htmlentities( $chart->url, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" method=\"post\" data-role=\"dateForm\" data-ipsForm>\n\t\t\t\t\t\t\nCONTENT;\n$return .= \\IPS\\Theme::i()->getTemplate( \"forms\", \"core\", 'global' )->date( 'start', $chart->start ? $chart->start->localeDate() : NULL, FALSE, NULL, NULL, FALSE, FALSE, NULL, NULL, array(), TRUE, 'ipsField_fullWidth', \\IPS\\Member::loggedIn()->language()->addToStack('stats_start_date') );\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<br><br>\n\t\t\t\t\t\t\nCONTENT;\n$return .= \\IPS\\Theme::i()->getTemplate( \"forms\", \"core\", 'global' )->date( 'end', $chart->start ? $chart->start->localeDate() : NULL, FALSE, NULL, NULL, FALSE, FALSE, NULL, NULL, array(), TRUE, 'ipsField_fullWidth', \\IPS\\Member::loggedIn()->language()->addToStack('stats_end_date') );\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<br><br>\n\t\t\t\t\t\t<button type=\"submit\" class=\"ipsButton ipsButton_primary ipsButton_fullWidth\" data-role=\"updateDate\">\nCONTENT;\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'submit', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/button>\n\t\t\t\t\t<\/form>\n\t\t\t\t<\/div>\n\t\t\t<\/li>\n\t\t\t\nCONTENT;\n\nif ( count( $chart->availableFilters ) > 0 ):\n$return .= <<<CONTENT\n\n\t\t\t\t<li>\n\t\t\t\t\t<a data-action=\"chartFilter\" data-ipsMenu data-ipsMenu-selectable data-ipsMenu-closeOnClick='false' id='el\nCONTENT;\n$return .= htmlentities( $chart->identifier, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\nFilter' href=\"#\" class=\"ipsButton ipsButton_verySmall ipsButton_veryLight\"><i class='fa fa-filter'><\/i> &nbsp;\nCONTENT;\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'stats_chart_filters', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n <i class='fa fa-caret-down'><\/i><\/a>\n\t\t\t\t\t<ul id='el\nCONTENT;\n$return .= htmlentities( $chart->identifier, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\nFilter_menu' class='ipsMenu ipsMenu_selectable ipsMenu_auto ipsHide' data-role='filterMenu'>\n\t\t\t\t\t\t\nCONTENT;\n\nforeach ( $chart->availableFilters as $f => $name ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<li class='ipsMenu_item \nCONTENT;\n\nif ( in_array( $f, $chart->currentFilters ) ):\n$return .= <<<CONTENT\nipsMenu_itemChecked\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n' data-ipsMenuValue='\nCONTENT;\n$return .= htmlentities( $f, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'><a href=\"\nCONTENT;\n$return .= htmlentities( $chart->flipUrlFilter( $f ), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\">\nCONTENT;\n$return .= htmlentities( $name, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t\t\t\t\t<\/ul>\n\t\t\t\t<\/li>\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nif ( count( $chart->availableTypes ) > 1 ):\n$return .= <<<CONTENT\n\n\t\t\t\t<li class='ipsPos_right'>\n\t\t\t\t\t<span class=\"ipsButton_split ipsClearfix\">\n\t\t\t\t\t\t\nCONTENT;\n\nforeach ( $chart->availableTypes as $t ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<a class='ipsButton ipsButton_verySmall \nCONTENT;\n\nif ( $chart->type == $t ):\n$return .= <<<CONTENT\nipsButton_primary\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\nipsButton_veryLight\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n' href=\"\nCONTENT;\n$return .= htmlentities( $chart->url->setQueryString( array( 'type' => array( $chart->identifier => $t ), 'noheader' => 1 ) ), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" data-ipsTooltip title='\nCONTENT;\n$val = \"chart_{$t}\"; $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( $val, \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n' data-type='\nCONTENT;\n$return .= htmlentities( $t, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' \nCONTENT;\n\nif ( $chart->type == $t ):\n$return .= <<<CONTENT\ndata-selected\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n>\n\t\t\t\t\t\t\t\t\nCONTENT;\n\nif ( $t === 'Table' ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t<i class=\"fa fa-table\"><\/i>\n\t\t\t\t\t\t\t\t\nCONTENT;\n\nelseif ( $t === 'LineChart' ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t<i class=\"fa fa-line-chart\"><\/i>\n\t\t\t\t\t\t\t\t\nCONTENT;\n\nelseif ( $t === 'ColumnChart' ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t<i class=\"fa fa-bar-chart\"><\/i>\n\t\t\t\t\t\t\t\t\nCONTENT;\n\nelseif ( $t === 'BarChart' ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t<i class=\"fa fa-bar-chart fa-rotate-90\"><\/i>\n\t\t\t\t\t\t\t\t\nCONTENT;\n\nelseif ( $t === 'PieChart' ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t<i class=\"fa fa-pie-chart\"><\/i>\n\t\t\t\t\t\t\t\t\nCONTENT;\n\nelseif ( $t === 'GeoChart' ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t<i class=\"fa fa-globe\"><\/i>\n\t\t\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<\/a>\n\t\t\t\t\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t\t\t\t\t<\/span>\n\t\t\t\t<\/li>\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t<\/ul>\n\t\t\n\t<\/div>\n\t<div class='ipsChart_chart ipsPad' data-role=\"chart\">\n\t\t{$html}\n\t<\/div>\n<\/div>\nCONTENT;\n\t\treturn $return;\n}\n\n\tfunction includeCSS(  ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\nCONTENT;\n\nforeach ( array_unique( \\IPS\\Output::i()->cssFiles, SORT_STRING ) as $file ):\n$return .= <<<CONTENT\n\n\t<link rel='stylesheet' href='\nCONTENT;\n$return .= htmlspecialchars( \\IPS\\Http\\Url::external( $file )->setQueryString( 'v', \\IPS\\SUITE_UNIQUE_KEY ), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' media='all'>\n\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\nCONTENT;\n\n$customCss = \\IPS\\Theme::i()->css( 'custom.css', 'core', 'front' );\n$return .= <<<CONTENT\n\n\nCONTENT;\n\nforeach ( $customCss as $css ):\n$return .= <<<CONTENT\n\n<link rel='stylesheet' href='\nCONTENT;\n$return .= htmlspecialchars( \\IPS\\Http\\Url::external( $css )->setQueryString( 'v', \\IPS\\SUITE_UNIQUE_KEY ), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' media='all'>\n\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\nCONTENT;\n\nif ( \\IPS\\Output::i()->headCss ):\n$return .= <<<CONTENT\n\n<style type='text\/css'>\n\t\nCONTENT;\n$return .= \\IPS\\Output::i()->headCss;\n$return .= <<<CONTENT\n\n<\/style>\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\nCONTENT;\n\t\treturn $return;\n}\n\n\tfunction includeJS(  ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\nCONTENT;\n\nif ( !\\IPS\\Request::i()->isAjax() ):\n$return .= <<<CONTENT\n\n\t<script type='text\/javascript'>\n\t\tvar ipsDebug = \nCONTENT;\n\nif ( ( \\IPS\\IN_DEV and \\IPS\\DEV_DEBUG_JS ) or \\IPS\\DEBUG_JS ):\n$return .= <<<CONTENT\ntrue\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\nfalse\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n;\t\t\n\t\nCONTENT;\n\nif ( \\IPS\\IN_DEV ):\n$return .= <<<CONTENT\n\n\t\tvar CKEDITOR_BASEPATH = '\nCONTENT;\n$return .= str_replace( '&', '&amp;', \\IPS\\Http\\Url::internal( \"applications\/core\/dev\/ckeditor\/\", \"none\", \"\", array(), 0 ) );\n$return .= <<<CONTENT\n';\n\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\tvar CKEDITOR_BASEPATH = '\nCONTENT;\n$return .= str_replace( '&', '&amp;', \\IPS\\Http\\Url::internal( \"applications\/core\/interface\/ckeditor\/ckeditor\/\", \"none\", \"\", array(), 0 ) );\n$return .= <<<CONTENT\n';\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\tvar ipsSettings = {\n\t\t\t\nCONTENT;\n\nif ( \\IPS\\Dispatcher::hasInstance() and \\IPS\\Dispatcher::i()->controllerLocation == 'admin' ):\n$return .= <<<CONTENT\n\n\t\t\tadsess: \"\nCONTENT;\n$return .= htmlspecialchars( \\IPS\\Request::i()->adsess, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\",\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nif ( \\IPS\\COOKIE_DOMAIN !== NULL ):\n$return .= <<<CONTENT\n\n\t\t\tcookie_domain: \"\nCONTENT;\n$return .= htmlspecialchars( \\IPS\\COOKIE_DOMAIN, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\",\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nif ( \\IPS\\COOKIE_PATH !== NULL ):\n$return .= <<<CONTENT\n\n\t\t\tcookie_path: \"\nCONTENT;\n$return .= htmlspecialchars( \\IPS\\COOKIE_PATH, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\",\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nif ( \\IPS\\COOKIE_PREFIX !== NULL ):\n$return .= <<<CONTENT\n\n\t\t\tcookie_prefix: \"\nCONTENT;\n$return .= htmlspecialchars( \\IPS\\COOKIE_PREFIX, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\",\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nif ( mb_substr( \\IPS\\Settings::i()->base_url, 0, 5 ) == 'https' AND !\\IPS\\COOKIE_BYPASS_SSLONLY ):\n$return .= <<<CONTENT\n\n\t\t\tcookie_ssl: true,\n\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\tcookie_ssl: false,\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\timgURL: \"\nCONTENT;\n$return .= \\IPS\\Theme::i()->resource( \".\/\", \"\", 'front' );\n$return .= <<<CONTENT\n\",\n\t\t\tbaseURL: \"\nCONTENT;\n$return .= \\IPS\\Settings::i()->base_url;\n$return .= <<<CONTENT\n\",\n\t\t\tjsURL: \"\nCONTENT;\n$return .= \\IPS\\Settings::i()->base_url;\n$return .= <<<CONTENT\napplications\/core\/interface\/js\/js.php\",\n\t\t\tcsrfKey: \"\nCONTENT;\n$return .= htmlspecialchars( \\IPS\\Session::i()->csrfKey, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\",\n\t\t\tantiCache: \"\nCONTENT;\n$return .= htmlspecialchars( \\IPS\\SUITE_UNIQUE_KEY, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\",\n\t\t\tuseCompiledFiles: \nCONTENT;\n\nif ( \\IPS\\IN_DEV ):\n$return .= <<<CONTENT\nfalse\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\ntrue\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n,\n\t\t\tlinks_external: \nCONTENT;\n$return .= \\IPS\\Settings::i()->links_external;\n$return .= <<<CONTENT\n\n\t\t};\n\t<\/script>\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\nCONTENT;\n\nforeach ( array_unique( \\IPS\\Output::i()->jsFiles, SORT_STRING ) as $js ):\n$return .= <<<CONTENT\n\n\nCONTENT;\n\n$js = \\IPS\\Http\\Url::external( $js );\n$return .= <<<CONTENT\n\n<script type='text\/javascript' src='\nCONTENT;\n\nif ( $js->data['host'] == parse_url( \\IPS\\Settings::i()->base_url, PHP_URL_HOST ) ):\n$return .= <<<CONTENT\n\nCONTENT;\n$return .= htmlspecialchars( $js->setQueryString( 'v', \\IPS\\SUITE_UNIQUE_KEY ), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\nCONTENT;\n$return .= htmlspecialchars( $js, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n' data-ips><\/script>\n\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\nCONTENT;\n\nforeach ( array_unique( \\IPS\\Output::i()->jsFilesAsync, SORT_STRING ) as $js ):\n$return .= <<<CONTENT\n\n<script type=\"text\/javascript\" src=\"\nCONTENT;\n$return .= htmlspecialchars( \\IPS\\Http\\Url::external( $js )->setQueryString( 'v', \\IPS\\SUITE_UNIQUE_KEY ), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" async=\"true\"><\/script>\n\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\nCONTENT;\n\nif ( count( \\IPS\\Output::i()->jsVars ) || \\IPS\\Output::i()->headJs ):\n$return .= <<<CONTENT\n\n\t<script type='text\/javascript'>\n\t\t\nCONTENT;\n\nforeach ( \\IPS\\Output::i()->jsVars as $k => $v ):\n$return .= <<<CONTENT\n\n\t\t\tips.setSetting( '\nCONTENT;\n$return .= htmlentities( $k, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n', jQuery.parseJSON('\nCONTENT;\n$return .= json_encode( $v );\n$return .= <<<CONTENT\n') );\n\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n$return .= \\IPS\\Output::i()->headJs;\n$return .= <<<CONTENT\n\n\t<\/script>\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n<script>\n  var ButtonAnimation = function() {\n\tvar anim_time = 150;\n\tvar anim_timeout = [];\n\tvar options = {\n\t\t\".main-menu .main\": {\n\t\t\tsteps: 7\n\t\t},\n\n\t\t\".main-menu .about\": {\n\t\t\tsteps: 7\n\t\t},\n\n\t\t\".main-menu .media\": {\n\t\t\tsteps: 7\n\t\t},\n\n\t\t\".main-menu .forum\": {\n\t\t\tsteps: 7\n\t\t},\n\n\t\t\".main-menu .blog\": {\n\t\t\tsteps: 7\n\t\t},\n\n\t\t\".main-menu .mobile\": {\n\t\t\tsteps: 8\n\t\t},\n\n\t\t\".header .play-button\": {\n\t\t\tsteps: 22\n\t\t},\n\n\t\t\".column-right .button-registration\": {\n\t\t\tsteps: 5\n\t\t},\n\n\t\t\".inner-page-menu .li-registration-button\": {\n\t\t\tsteps: 5\n\t\t},\n\n\t\t\"li.registration-button\": {\n\t\t\tsteps: 4\n\t\t},\n\n\t\t\".social-button-holder .soc-vk\": {\n\t\t\tsteps: 3\n\t\t},\n\n\t\t\".social-button-holder .soc-fb\": {\n\t\t\tsteps: 3\n\t\t},\n\n\t\t\".social-button-holder .soc-tw\": {\n\t\t\tsteps: 3\n\t\t},\n\n\t\t\".store .google-play-holder\": {\n\t\t\tsteps: 3\n\t\t},\n\n\t\t\".store .app-store-holder\": {\n\t\t\tsteps: 3\n\t\t}\n\t};\n\tvar Animation = function(step, elem, direction) {\n\t\tvar this_steps = options[elem].steps;\n\t\tvar this_elem = $(elem);\n\t\tif(direction == 'hover') {\n\t\t\tstep++;\n\t\t} else {\n\t\t\tstep--;\n\t\t}\n\t\tvar new_pos = step * this_elem.width() * (-1);\n\t\tthis_elem\n\t\t\t.css('background-position',  new_pos + 'px 0')\n\t\t\t.attr('data-active-step', step);\n\t\tanim_timeout[elem] = setTimeout(function(){\n\t\t\tif(step < this_steps - 1 && step > 0) {\n\t\t\t\tAnimation(step, elem, direction);\n\t\t\t}\n\t\t}, anim_time\/this_steps);\n\t}\n\t$.each(options, function(index, value){\n\t\tif(!$(index).hasClass('active')) {\n\t\t\t$(index).css('background-size', 100*value.steps + '% 100%');\n\t\t\t$(index).on('mouseenter', function(){\n\t\t\t\tclearTimeout(anim_timeout[index]);\n\t\t\t\tvar start_step = 0;\n\t\t\t\tif($(this).attr('data-active-step')) {\n\t\t\t\t\tstart_step = $(this).attr('data-active-step');\n\t\t\t\t}\n\t\t\t\tAnimation(start_step, index, 'hover');\n\t\t\t}).on('mouseleave', function(){\n\t\t\t\tclearTimeout(anim_timeout[index]);\n\t\t\t\tAnimation($(this).attr('data-active-step'), index, 'hoverout');\n\t\t\t});\n\t\t}\n\t});\n}\nButtonAnimation();\n  \n  $('#elUpdates').on('click', function(){\n$('#elProfileTabs').css('background-position', '0 -40px');\n});\n$('#elActivity').on('click', function(){\n$('#elProfileTabs').css('background-position', '0 0');\n})\n<\/script>\n\nCONTENT;\n\t\treturn $return;\n}\n\n\tfunction includeMeta(  ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n<meta charset=\"utf-8\">\n\nCONTENT;\n\nif ( \\IPS\\Theme::i()->settings['responsive'] ):\n$return .= <<<CONTENT\n\n\t<meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\nCONTENT;\n\nif ( !isset( \\IPS\\Output::i()->metaTags['og:image'] ) and \\IPS\\Theme::i()->logo_sharer  ):\n$return .= <<<CONTENT\n\n\t<meta property=\"og:image\" content=\"\nCONTENT;\n$return .= \\IPS\\Theme::i()->logo_sharer;\n$return .= <<<CONTENT\n\">\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\nCONTENT;\n\nforeach ( \\IPS\\Output::i()->metaTags as $name => $content ):\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\nif ( $name != 'title' ):\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nif ( is_array( $content )  ):\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nforeach ( $content as $_value  ):\n$return .= <<<CONTENT\n\n\t\t\t\t<meta \nCONTENT;\n\nif ( mb_substr( $name, 0, 3 ) === 'og:' ):\n$return .= <<<CONTENT\nproperty\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\nname\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n=\"\nCONTENT;\n$return .= htmlentities( $name, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" content=\"\nCONTENT;\n$return .= htmlentities( $_value, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\">\n\t\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t<meta \nCONTENT;\n\nif ( mb_substr( $name, 0, 3 ) === 'og:' ):\n$return .= <<<CONTENT\nproperty\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\nname\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n=\"\nCONTENT;\n$return .= htmlentities( $name, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" content=\"\nCONTENT;\n$return .= htmlentities( $content, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\">\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\nCONTENT;\n\nforeach ( \\IPS\\Output::i()->linkTags as $type => $href ):\n$return .= <<<CONTENT\n<link rel=\"\nCONTENT;\n$return .= htmlentities( $type, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" href=\"\nCONTENT;\n$return .= htmlspecialchars( $href, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" \/>\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\nCONTENT;\n\nforeach ( \\IPS\\Output::i()->rssFeeds as $title => $url ):\n$return .= <<<CONTENT\n<link rel=\"alternate\" type=\"application\/rss+xml\" title=\"\nCONTENT;\n$val = \"{$title}\"; $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( $val, \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\" href=\"\nCONTENT;\n$return .= htmlentities( $url, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" \/>\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\nCONTENT;\n\nif ( \\IPS\\Output::i()->base ):\n$return .= <<<CONTENT\n\n\t<base target=\"\nCONTENT;\n$return .= htmlspecialchars( \\IPS\\Output::i()->base, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\">\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\nCONTENT;\n\t\treturn $return;\n}\n\n\tfunction lkeyWarning(  ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\nCONTENT;\n\nif ( $lkeyWarning = \\IPS\\Output::i()->licenseKeyWarning() ):\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\nif ( $lkeyWarning == 'none' ):\n$return .= <<<CONTENT\n\n\t\t<div class=\"ipsMessage ipsMessage_error\" id='elLicenseKey'>\n\t\t\t\nCONTENT;\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'license_error_none', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n\t\t<\/div>\n\t\nCONTENT;\n\nelseif ( $lkeyWarning == 'expired' && !isset( \\IPS\\Request::i()->cookie['licenseDismiss'] ) ):\n$return .= <<<CONTENT\n\n\t\t<div class=\"ipsMessage ipsMessage_general\" id='elLicenseKey' data-controller='core.global.core.license'>\n\t\t\t\nCONTENT;\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'license_error_expired', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n\t\t\t<ul class='ipsList_inline'>\n\t\t\t\t<li>\n\t\t\t\t\t<a href='\nCONTENT;\n$return .= \\IPS\\Http\\Url::ips( \"docs\/renew_my_license\" );\n$return .= <<<CONTENT\n' class='ipsButton ipsButton_verySmall ipsButton_veryLight'>\nCONTENT;\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'license_renew_now', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t\t<\/li>\n\t\t\t\t<li>\n\t\t\t\t\t<a href='\nCONTENT;\n$return .= str_replace( '&', '&amp;', \\IPS\\Http\\Url::internal( \"app=core&module=settings&controller=licensekey&do=refresh\", \"admin\", \"\", array(), 0 ) );\n$return .= <<<CONTENT\n' class='ipsButton ipsButton_verySmall ipsButton_veryLight'>\nCONTENT;\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'license_check_again', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t\t<\/li>\n\t\t\t<\/ul>\n\t\t\t<a href='#' data-role='closeMessage' data-ipsTooltip title='\nCONTENT;\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'license_dismiss', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n'>&times;<\/a>\n\t\t<\/div>\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\nCONTENT;\n\t\treturn $return;\n}\n\n\tfunction message( $message, $type, $debug=NULL, $parse=TRUE ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\nCONTENT;\n\nif ( $debug !== NULL ):\n$return .= <<<CONTENT\n\n\t<div class=\"ipsMessage ipsMessage_\nCONTENT;\n$return .= htmlentities( $type, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\">\n\t\t\nCONTENT;\n\nif ( $parse ):\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n$val = \"{$message}\"; $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( $val, \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t{$message}\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t<br><br>\n\t\t<pre>\nCONTENT;\n$return .= htmlentities( $debug, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/pre>\n\t<\/div>\n\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t<p class=\"ipsMessage ipsMessage_\nCONTENT;\n$return .= htmlentities( $type, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\">\n\t\t\nCONTENT;\n\nif ( $parse ):\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n$val = \"{$message}\"; $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( $val, \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t{$message}\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t<\/p>\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\nCONTENT;\n\t\treturn $return;\n}\n\n\tfunction miniPagination( $baseUrl, $pages, $activePage=1, $perPage=25, $ajax=FALSE, $pageParam='page' ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\nCONTENT;\n\nif ( $pages > 1 ):\n$return .= <<<CONTENT\n\n\t<ul class='ipsPagination ipsPagination_mini' id='elPagination_\nCONTENT;\n$return .= htmlspecialchars( md5($baseUrl), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'>\n\t\t\nCONTENT;\n\nforeach ( range( 1, ( 4 > $pages ) ? $pages : 4 ) as $i ):\n$return .= <<<CONTENT\n\n\t\t\t<li class='ipsPagination_page'><a href='\nCONTENT;\n$return .= htmlentities( $baseUrl->setQueryString( $pageParam, $i ), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-ipsTooltip title='\nCONTENT;\n$sprintf = array($i); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'go_to_page_x', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), FALSE, array( 'sprintf' => $sprintf ) );\n$return .= <<<CONTENT\n'>\nCONTENT;\n$return .= htmlentities( $i, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nif ( $pages > 4 ):\n$return .= <<<CONTENT\n\n\t\t\t<li class='ipsPagination_last'><a href='\nCONTENT;\n$return .= htmlentities( $baseUrl->setQueryString( $pageParam, $pages ), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-ipsTooltip title='\nCONTENT;\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'last_page', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n'>\nCONTENT;\n$return .= htmlentities( $pages, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n <i class='fa fa-caret-right'><\/i><\/a><\/li>\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t<\/ul>\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\nCONTENT;\n\t\treturn $return;\n}\n\n\tfunction multipleRedirect( $url ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n<div class=\"ipsJS_hide\">\n\t<a href='\nCONTENT;\n$return .= htmlentities( $url->setQueryString( 'mr', 0 ), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' class=\"button\">\nCONTENT;\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'start', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n<\/div>\n<div data-controller=\"core.global.core.multipleRedirect\" data-url=\"\nCONTENT;\n$return .= htmlentities( $url, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\">\n\t<div class=\"ipsRedirect ipsHide ipsPad\">\n\t\t<div class=\"ipsLoading ipsRedirect_loading\" data-role=\"loadingIcon\"><\/div>\n\t\t<div class=\"ipsRedirect_progress ipsHide\" data-role=\"progressBarContainer\">\n\t\t\t<div class=\"ipsProgressBar ipsProgressBar_animated\">\n\t\t\t\t<div class=\"ipsProgressBar_progress\" data-role=\"progressBar\"><\/div>\n\t\t\t<\/div>\n\t\t<\/div>\n\t\t<span data-role=\"message\"><\/span>\n\t<\/div>\n<\/div>\nCONTENT;\n\t\treturn $return;\n}\n\n\tfunction pagination( $baseUrl, $pages, $activePage=1, $perPage=25, $ajax=TRUE, $pageParam='page' ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\nCONTENT;\n\nif ( $activePage > 1 || $pages > 1 ):\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\n$uniqId = uniqid();\n$return .= <<<CONTENT\n\n\t<ul class='ipsPagination' id='elPagination_\nCONTENT;\n$return .= htmlspecialchars( md5($baseUrl), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_\nCONTENT;\n$return .= htmlentities( $uniqId, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-pages='\nCONTENT;\n$return .= htmlentities( $pages, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' \nCONTENT;\n\nif ( $ajax ):\n$return .= <<<CONTENT\ndata-ipsPagination \nCONTENT;\n\nif ( $pageParam != 'page' ):\n$return .= <<<CONTENT\ndata-ipsPagination-pageParam='\nCONTENT;\n$return .= htmlentities( $pageParam, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n data-ipsPagination-pages=\"\nCONTENT;\n$return .= htmlentities( $pages, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" data-ipsPagination-perPage='\nCONTENT;\n$return .= htmlentities( $perPage, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n>\n\t\t\nCONTENT;\n\nif ( $activePage != 1 ):\n$return .= <<<CONTENT\n\n\t\t\t<li class='ipsPagination_first'><a href='\nCONTENT;\n$return .= htmlentities( $baseUrl->setQueryString( $pageParam, 1 ), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-page='1' data-ipsTooltip title='\nCONTENT;\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'first_page', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n'><i class='fa fa-backward'><\/i><\/a><\/li>\n\t\t\t<li class='ipsPagination_prev'><a href='\nCONTENT;\n$return .= htmlentities( $baseUrl->setQueryString( $pageParam, $activePage - 1 ), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-page='\nCONTENT;\n$return .= htmlspecialchars( $activePage - 1, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'>\nCONTENT;\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'prev', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\nCONTENT;\n\nforeach ( range( ( ( $activePage - 5 ) > 0 ) ? ( $activePage - 5 ) : 1, $activePage - 1 ) as $idx => $i ):\n$return .= <<<CONTENT\n\n\t\t\t\t<li class='ipsPagination_page \nCONTENT;\n\nif ( $idx < 3 ):\n$return .= <<<CONTENT\nipsResponsive_hidePhone\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n'><a href='\nCONTENT;\n$return .= htmlentities( $baseUrl->setQueryString( $pageParam, $i ), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-page='\nCONTENT;\n$return .= htmlentities( $i, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'>\nCONTENT;\n$return .= htmlentities( $i, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t<li class='ipsPagination_page ipsPagination_active'><a href='\nCONTENT;\n$return .= htmlentities( $baseUrl->setQueryString( $pageParam, $activePage ), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-page='\nCONTENT;\n$return .= htmlentities( $activePage, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'>\nCONTENT;\n$return .= htmlentities( $activePage, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\nCONTENT;\n\nif ( $activePage != $pages ):\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nforeach ( range( $activePage + 1, ( ( $activePage + 5 ) > $pages ) ? $pages : ( $activePage + 5 ) ) as $idx => $i ):\n$return .= <<<CONTENT\n\n\t\t\t\t<li class='ipsPagination_page \nCONTENT;\n\nif ( $idx > 1 ):\n$return .= <<<CONTENT\nipsResponsive_hidePhone\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n'><a href='\nCONTENT;\n$return .= htmlentities( $baseUrl->setQueryString( $pageParam, $i ), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-page='\nCONTENT;\n$return .= htmlentities( $i, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'>\nCONTENT;\n$return .= htmlentities( $i, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t\t\t<li class='ipsPagination_next'><a href='\nCONTENT;\n$return .= htmlentities( $baseUrl->setQueryString( $pageParam, $activePage + 1 ), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-page='\nCONTENT;\n$return .= htmlspecialchars( $activePage + 1, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'>\nCONTENT;\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'next', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t<li class='ipsPagination_last'><a href='\nCONTENT;\n$return .= htmlentities( $baseUrl->setQueryString( $pageParam, $pages ), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-page='\nCONTENT;\n$return .= htmlentities( $pages, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-ipsTooltip title='\nCONTENT;\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'last_page', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n'><i class='fa fa-forward'><\/i><\/a><\/li>\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nif ( $pages > 1 ):\n$return .= <<<CONTENT\n\n\t\t\t<li class='ipsPagination_pageJump'>\n\t\t\t\t<a href='#' data-ipsMenu data-ipsMenu-closeOnClick='false' data-ipsMenu-appendTo='#elPagination_\nCONTENT;\n$return .= htmlspecialchars( md5($baseUrl), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_\nCONTENT;\n$return .= htmlentities( $uniqId, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' id='elPagination_\nCONTENT;\n$return .= htmlspecialchars( md5($baseUrl), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_jump'>\nCONTENT;\n$sprintf = array($activePage, $pages); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'pagination', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), FALSE, array( 'sprintf' => $sprintf ) );\n$return .= <<<CONTENT\n &nbsp;<i class='fa fa-caret-down'><\/i><\/a>\n\t\t\t\t<div class='ipsMenu ipsMenu_narrow ipsPad ipsHide' id='elPagination_\nCONTENT;\n$return .= htmlspecialchars( md5($baseUrl), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_jump_menu'>\n\t\t\t\t\t<form accept-charset='utf-8' method='post' action='\nCONTENT;\n$return .= htmlentities( $baseUrl->setQueryString( 'page', NULL ), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-role=\"pageJump\">\n\t\t\t\t\t\t<ul class='ipsForm ipsForm_horizontal'>\n\t\t\t\t\t\t\t<li class='ipsFieldRow'>\n\t\t\t\t\t\t\t\t<input type='number' min='1' max='\nCONTENT;\n$return .= htmlentities( $pages, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' value=\"\nCONTENT;\n$return .= htmlentities( $activePage, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" placeholder='\nCONTENT;\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'page_number', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n' class='ipsField_fullWidth' name='\nCONTENT;\n$return .= htmlentities( $pageParam, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'>\n\t\t\t\t\t\t\t<\/li>\n\t\t\t\t\t\t\t<li class='ipsFieldRow ipsFieldRow_fullWidth'>\n\t\t\t\t\t\t\t\t<input type='submit' class='ipsButton_fullWidth ipsButton ipsButton_verySmall ipsButton_primary' value='\nCONTENT;\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'go', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n'>\n\t\t\t\t\t\t\t<\/li>\n\t\t\t\t\t\t<\/ul>\n\t\t\t\t\t<\/form>\n\t\t\t\t<\/div>\n\t\t\t<\/li>\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t<\/ul>\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\nCONTENT;\n\t\treturn $return;\n}\n\n\tfunction poll( $poll, $url ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\nCONTENT;\n\nif ( !isset( \\IPS\\Request::i()->fetchPoll ) ):\n$return .= <<<CONTENT\n\n<section class='ipsBox' data-controller='core.front.core.poll'>\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t<h2 class='ipsType_sectionTitle ipsType_reset'>\n\t\t\nCONTENT;\n$return .= \\IPS\\Lang::wordbreak( htmlentities( $poll->poll_question, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ) );;\n$return .= <<<CONTENT\n&nbsp;&nbsp;\n\t\t<span class='ipsType_normal ipsType_light'>\nCONTENT;\n$pluralize = array( $poll->votes ); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'poll_num_votes', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), FALSE, array( 'pluralize' => $pluralize ) );\n$return .= <<<CONTENT\n<\/span>\n\t<\/h2>\n\t<div class='ipsPad ipsClearfix' data-role='pollContents'>\n\t\t\nCONTENT;\n\nif ( $poll->canVote() and \\IPS\\Request::i()->_poll != 'results' and ( !$poll->getVote() or \\IPS\\Request::i()->_poll == 'form') and $pollForm = $poll->buildForm() ):\n$return .= <<<CONTENT\n\n\t\t\t{$pollForm->customTemplate( array( \\IPS\\Theme::i()->getTemplate( 'global', 'core', 'global' ), 'pollForm' ), $url )}\n\t\t\nCONTENT;\n\nelseif ( !$poll->canVote() or $poll->getVote() or ( \\IPS\\Request::i()->_poll == 'results' and \\IPS\\Settings::i()->allow_result_view ) ):\n$return .= <<<CONTENT\n\n\t\t\t<ol class='ipsList_reset cPollList'>\n\t\t\t\t\nCONTENT;\n\nforeach ( $poll->choices as $questionId => $question ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<li>\n\t\t\t\t\t\t<h3 class='ipsType_sectionHead'>\nCONTENT;\n$return .= htmlentities( $questionId, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n. \nCONTENT;\n$return .= \\IPS\\Lang::wordbreak( htmlentities( $question['question'], ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ) );;\n$return .= <<<CONTENT\n<\/h3>\n\t\t\t\t\t\t<ul class='ipsList_reset cPollList_choices'>\n\t\t\t\t\t\t\t\nCONTENT;\n\nforeach ( $question['choice'] as $k => $choice ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t<li class='ipsGrid ipsGrid_collapsePhone'>\n\t\t\t\t\t\t\t\t\t<div class='ipsGrid_span4 ipsType_right ipsType_richText ipsType_break'>\n\t\t\t\t\t\t\t\t\t\t{$choice}\n\t\t\t\t\t\t\t\t\t<\/div>\n\t\t\t\t\t\t\t\t\t<div class='ipsGrid_span7'>\n\t\t\t\t\t\t\t\t\t\t<span class='cPollVoteBar'>\n\t\t\t\t\t\t\t\t\t\t\t<span style='width: \nCONTENT;\n\nif ( $poll->votes ):\n$return .= <<<CONTENT\n\nCONTENT;\n$return .= htmlspecialchars( intval( ( $question['votes'][ $k ] \/ $poll->votes ) * 100 ), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n0\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n%' data-votes='\nCONTENT;\n\nif ( $poll->votes ):\n$return .= <<<CONTENT\n\nCONTENT;\n$return .= htmlspecialchars( round( ( $question['votes'][ $k ] \/ $poll->votes ) * 100, 2 ), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n0\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n%' \nCONTENT;\n\nif ( $poll->votes && intval( ( $question['votes'][ $k ] \/ $poll->votes ) * 100 ) > 30 ):\n$return .= <<<CONTENT\nclass='cPollVoteBar_inside'\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n><\/span>\n\t\t\t\t\t\t\t\t\t\t<\/span>\n\t\t\t\t\t\t\t\t\t<\/div>\n\t\t\t\t\t\t\t\t\t<div class='ipsGrid_span1 ipsType_small'>\n\t\t\t\t\t\t\t\t\t\t\nCONTENT;\n\nif ( $poll->canSeeVoters() && $question['votes'][ $k ] > 0 ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t\t\t<a href='\nCONTENT;\n$return .= str_replace( '&', '&amp;', \\IPS\\Http\\Url::internal( \"app=core&module=system&controller=poll&do=voters&id={$poll->pid}&question={$questionId}&option={$k}\", null, \"\", array(), 0 ) );\n$return .= <<<CONTENT\n' title='\nCONTENT;\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'view_voters', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n' class='ipsType_blendLinks' data-ipsTooltip data-ipsDialog data-ipsDialog-size=\"narrow\" data-ipsDialog-title=\"\nCONTENT;\n$return .= htmlentities( $choice, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\">\n\t\t\t\t\t\t\t\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t\t\t<span class='ipsFaded'>\n\t\t\t\t\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t\t\t<i class='fa fa-user'><\/i> \nCONTENT;\n$return .= htmlentities( $question['votes'][ $k ], ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t\t\nCONTENT;\n\nif ( $poll->canSeeVoters() && $question['votes'][ $k ] > 0 ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t\t\t<\/a>\n\t\t\t\t\t\t\t\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t\t\t<\/span>\n\t\t\t\t\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t<\/div>\n\t\t\t\t\t\t\t\t<\/li>\n\t\t\t\t\t\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<\/ul>\n\t\t\t\t\t<\/li>\n\t\t\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t\t\t<\/ol>\n\t\t\t\nCONTENT;\n\nif ( $poll->canVote() || !\\IPS\\Member::loggedIn()->member_id ):\n$return .= <<<CONTENT\n\n\t\t\t\t<hr class='ipsHr'>\n\t\t\t\t\nCONTENT;\n\nif ( $poll->canVote() ):\n$return .= <<<CONTENT\n<a href=\"\nCONTENT;\n$return .= htmlentities( $url->setQueryString( '_poll', 'form' ), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" title='\nCONTENT;\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'show_vote_options_title', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n' class='ipsButton ipsButton_verySmall ipsButton_light' data-action='viewResults'><i class='fa fa-caret-left'><\/i> \nCONTENT;\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'show_vote_options', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nif ( !\\IPS\\Member::loggedIn()->member_id ):\n$return .= <<<CONTENT\n\nCONTENT;\n$htmlsprintf = array(\\IPS\\Http\\Url::internal( 'app=core&module=system&controller=login', 'front', 'login' ), \\IPS\\Http\\Url::internal( 'app=core&module=system&controller=register', 'front', 'register' )); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'poll_guest', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), FALSE, array( 'htmlsprintf' => $htmlsprintf ) );\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t<\/div>\n\nCONTENT;\n\nif ( !isset( \\IPS\\Request::i()->fetchPoll ) ):\n$return .= <<<CONTENT\n\n<\/section>\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\nCONTENT;\n\t\treturn $return;\n}\n\n\tfunction pollForm( $url, $id, $action, $elements, $hiddenValues, $actionButtons, $uploadField, $class='', $attributes=array(), $sidebar, $form=NULL ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n<form accept-charset='utf-8' class=\"ipsForm \nCONTENT;\n$return .= htmlentities( $class, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" action=\"\nCONTENT;\n$return .= htmlentities( $action, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" method=\"post\" \nCONTENT;\n\nif ( $uploadField ):\n$return .= <<<CONTENT\nenctype=\"multipart\/form-data\"\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n \nCONTENT;\n\nforeach ( $attributes as $k => $v ):\n$return .= <<<CONTENT\n\nCONTENT;\n$return .= htmlentities( $k, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n=\"\nCONTENT;\n$return .= htmlentities( $v, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\"\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n data-ipsForm>\n\t<input type=\"hidden\" name=\"\nCONTENT;\n$return .= htmlentities( $id, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_submitted\" value=\"1\">\n\t\nCONTENT;\n\nforeach ( $hiddenValues as $k => $v ):\n$return .= <<<CONTENT\n\n\t\t<input type=\"hidden\" name=\"\nCONTENT;\n$return .= htmlentities( $k, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" value=\"\nCONTENT;\n$return .= htmlentities( $v, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\">\n\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\t\t\n\t\nCONTENT;\n\nforeach ( $elements as $collection ):\n$return .= <<<CONTENT\n\n\t\t<ol class='ipsList_reset cPollList cPollList_questions'>\n\t\t\t\nCONTENT;\n\nforeach ( $collection as $idx => $input ):\n$return .= <<<CONTENT\n\n\t\t\t\t<li class='ipsFieldRow ipsFieldRow_noLabel'>\n\t\t\t\t\t<h3 class='ipsType_sectionHead'>\nCONTENT;\n$return .= htmlentities( $idx, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n. \nCONTENT;\n$return .= \\IPS\\Lang::wordbreak( htmlentities( $input->label, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ) );;\n$return .= <<<CONTENT\n<\/h3>\n\t\t\t\t\t\nCONTENT;\n\nif ( !$input->options['multiple'] ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\nCONTENT;\n$return .= \\IPS\\Theme::i()->getTemplate( \"forms\", \"core\", 'global' )->radio( $input->name, $input->value, $input->required, $input->options['options'], $input->options['disabled'], '', $input->options['disabled'] );\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\nCONTENT;\n$return .= \\IPS\\Theme::i()->getTemplate( \"forms\", \"core\", 'global' )->checkboxset( $input->name, $input->value, $input->required, $input->options['options'], $input->options['disabled'], $input->options['toggles'], isset( $input->options['descriptions'] ) ? $input->options['descriptions'] : NULL, $input->options['userSuppliedInput'] );\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nif ( $input->error ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<br>\n\t\t\t\t\t\t<span class=\"ipsType_warning\">\nCONTENT;\n$val = \"{$input->error}\"; $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( $val, \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/span>\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t<\/li>\n\t\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t\t<\/ol>\n\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t<hr class='ipsHr'>\n\t<ul class=\"ipsPos_left ipsToolList ipsToolList_horizontal ipsList_reset ipsClearfix\">\n\t\t\nCONTENT;\n\nforeach ( $actionButtons as $button ):\n$return .= <<<CONTENT\n\n\t\t\t<li>{$button}<\/li>\n\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n        <li><a class='ipsButton ipsButton_link' title='\nCONTENT;\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'show_results_title', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n' href=\"\nCONTENT;\n$return .= htmlentities( $url->setQueryString( '_poll', 'results' ), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" \nCONTENT;\n\nif ( !\\IPS\\Settings::i()->allow_result_view ):\n$return .= <<<CONTENT\ndata-viewResults-confirm=\"\nCONTENT;\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'warn_allow_result_view', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\"\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n data-action='viewResults'>\nCONTENT;\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'show_results', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t<\/ul>\n<\/form>\nCONTENT;\n\t\treturn $return;\n}\n\n\tfunction pollVoters( $votes ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n<ul class=\"ipsGrid ipsGrid_collapsePhone ipsPad\">\n\t\nCONTENT;\n\nforeach ( $votes as $vote ):\n$return .= <<<CONTENT\n\n\t\t<li class='ipsGrid_span6 ipsPhotoPanel ipsPhotoPanel_mini'>\n\t\t\t\nCONTENT;\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->userPhoto( \\IPS\\Member::load( $vote->member_id ), 'mini' );\n$return .= <<<CONTENT\n\n\t\t\t<div class='ipsType_break'>\n\t\t\t\t<h3 class='ipsType_normal ipsType_reset ipsTruncate ipsTruncate_line'>\nCONTENT;\n$return .= htmlspecialchars( \\IPS\\Member::load( $vote->member_id )->name, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/h3>\n\t\t\t\t<span class=\"ipsType_light ipsType_medium\">\nCONTENT;\n$val = ( $vote->vote_date instanceof \\IPS\\DateTime ) ? $vote->vote_date : \\IPS\\DateTime::ts( $vote->vote_date );$return .= $val->html();\n$return .= <<<CONTENT\n<\/span>\n\t\t\t<\/div>\n\t\t<\/li>\n\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n<\/ul>\nCONTENT;\n\t\treturn $return;\n}\n\n\tfunction prettyprint( $code ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n<pre class='prettyprint'>\nCONTENT;\n$return .= htmlentities( $code, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/pre>\nCONTENT;\n\t\treturn $return;\n}\n\n\tfunction redirect( $url, $message ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n<!DOCTYPE html>\n<html lang=\"\nCONTENT;\n$return .= htmlspecialchars( \\IPS\\Member::loggedIn()->language()->bcp47(), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" dir=\"\nCONTENT;\n\nif ( \\IPS\\Member::loggedIn()->language()->isrtl ):\n$return .= <<<CONTENT\nrtl\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\nltr\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\">\n\t<head>\n\t\t<title>\nCONTENT;\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'redirecting', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/title>\n\t\t<meta http-equiv=\"refresh\" content=\"2; url=\nCONTENT;\n$return .= htmlentities( $url, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\">\n\t\t\nCONTENT;\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\", 'global' )->includeMeta(  );\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\", 'global' )->includeCSS(  );\n$return .= <<<CONTENT\n\n\t<\/head>\n\t<body>\n\t\t<p class=\"ipsMessage ipsMessage_info ipsRedirectMessage\">\n\t\t\t<strong>\nCONTENT;\n$val = \"{$message}\"; $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( $val, \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/strong><br>\n\t\t\t<br>\n\t\t\t\nCONTENT;\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'redirecting_wait', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n\t\t<\/p>\n\t\t\nCONTENT;\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\", 'global' )->includeJS(  );\n$return .= <<<CONTENT\n\n\t<\/body>\n<\/html>\nCONTENT;\n\t\treturn $return;\n}\n\n\tfunction textBlock( $message ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n<div class='ipsType_normal'>\n\t{$message}\n<\/div>\n<br>\n\n\nCONTENT;\n\t\treturn $return;\n}\n\n\tfunction truncatedUrl( $url, $newWindow=TRUE, $length=50 ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n<a href='\nCONTENT;\n$return .= htmlentities( $url, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'\nCONTENT;\n\nif ( $newWindow === TRUE ):\n$return .= <<<CONTENT\n target='_blank'\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n>\nCONTENT;\n$return .= htmlentities( mb_substr( $url, '0', $length ), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ) . ( ( mb_strlen( $url ) > $length ) ? '&hellip;' : '' );\n$return .= <<<CONTENT\n<\/a>\nCONTENT;\n\t\treturn $return;\n}\n\n\tfunction vineEmbed( $url ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n<div class=\"ipsEmbeddedVideo\"><iframe class=\"vine-embed\" src=\"\nCONTENT;\n$return .= htmlentities( $url, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\/embed\/simple\" width=\"600\" height=\"600\" frameborder=\"0\"><\/iframe><script async src=\"\/\/platform.vine.co\/static\/scripts\/embed.js\" charset=\"utf-8\"><\/script><\/div>\nCONTENT;\n\t\treturn $return;\n}\n\n\tfunction wizard( $stepNames, $activeStep, $output, $baseUrl, $showSteps ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n<div data-ipsWizard>\n\t\nCONTENT;\n\nif ( $showSteps ):\n$return .= <<<CONTENT\n\n\t\t<ul class=\"ipsStepBar ipsClearFix\" data-role=\"wizardStepbar\">\n\t\t\t\nCONTENT;\n\n$doneSteps = TRUE;\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nforeach ( $stepNames as $step => $name ):\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nif ( $activeStep == $name ):\n$return .= <<<CONTENT\n\nCONTENT;\n\n$doneSteps = FALSE;\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t<li class='ipsStep \nCONTENT;\n\nif ( $activeStep == $name ):\n$return .= <<<CONTENT\nipsStep_active\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n'>\n\t\t\t\t\t\nCONTENT;\n\nif ( $doneSteps ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<a href=\"\nCONTENT;\n$return .= htmlentities( $baseUrl->setQueryString( '_step', $name ), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" data-action=\"wizardLink\">\n\t\t\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<span>\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<strong class='ipsStep_title'>\nCONTENT;\n$sprintf = array($step + 1); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'step_number', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), FALSE, array( 'sprintf' => $sprintf ) );\n$return .= <<<CONTENT\n<\/strong>\n\t\t\t\t\t\t<span class='ipsStep_desc'>\nCONTENT;\n$val = \"{$name}\"; $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( $val, \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/span>\n\t\t\t\t\t\nCONTENT;\n\nif ( $doneSteps ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<\/a>\n\t\t\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<\/span>\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t<\/li>\n\t\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t\t<\/ul>\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t<div data-role=\"wizardContent\">\n\t\t{$output}\n\t<\/div>\n<\/div>\nCONTENT;\n\t\treturn $return;\n}}"